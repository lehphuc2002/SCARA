function [t, q, v, a] = LSPB_trajectory(qf, vmax, amax)
    tc = vmax/amax;
    tm = (qf - amax*((tc)^2))/vmax;   %t middle , tu tc --> tf-tc
    tf = 2*tc + tm;
    qc = (amax*((tc)^2))/2

    t = linspace(0, tf, 100);
    q = zeros(size(t));
    v = zeros(size(t));
    a = zeros(size(t));
    for i = 1:length(t)
        if t(i) <= tc
            q(i) = amax*t(i)^2/2;
            v(i) = amax*t(i);
            a(i) = amax;
        elseif t(i) <= tf - tc
            q(i) = qc + vmax*(t(i) - tc);
            v(i) = vmax;
            a(i) = 0;
        elseif t(i) <= tf
            q(i) = qf - amax*(tf -t(i))^2/2;
            v(i) = amax*(tf-t(i));
            a(i) = -amax;
        end
    end
end